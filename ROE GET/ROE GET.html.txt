<!DOCTYPE html>
<html lang="zh-TW">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>EPS â†’ BVPS / ROE æ¨¡æ“¬å™¨</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  <style>
    /* ç¢ºä¿ä¸­æ–‡å­—é«”é¡¯ç¤ºæ­£å¸¸ï¼Œä¸¦åŠ å…¥ Inter ä½œç‚ºæ¨™æº–å­—é«” */
    .font-sans {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
    }
    /* ç‚ºè¡¨æ ¼çš„å¶æ•¸è¡Œå¢åŠ è¼•å¾®èƒŒæ™¯è‰² */
    #tableBody tr:nth-child(even) {
      /* ä½¿ç”¨æ·ºæ·ºçš„å¥¶èŒ¶è‰²ç³»èƒŒæ™¯ */
      background-color: #fcfbf8; 
    }
Â  </style>
</head>
<!-- æš–è‰²èª¿èƒŒæ™¯ï¼šåŠ æ·±ç‚º bg-stone-200ï¼Œæ›´æœ‰å’–å•¡ç‰›å¥¶çš„æ„Ÿè¦º -->
<body class="bg-stone-200 p-4 md:p-8 font-sans">

Â  <!-- Custom Toast Message Area (å–ä»£ alert) -->
Â  <div id="messageBox" class="fixed top-5 right-5 z-50 p-4 text-white rounded-lg shadow-2xl transition-opacity duration-300 opacity-0 pointer-events-none min-w-[200px] text-center" role="alert"></div>

Â  <!-- å¡ç‰‡èƒŒæ™¯ï¼šbg-whiteï¼Œé‚Šæ¡†æ›æˆæš–ç°è‰² -->
Â  <div class="max-w-4xl mx-auto bg-white p-6 rounded-2xl shadow-2xl border border-stone-300">
Â  Â  <h1 class="text-3xl font-extrabold text-stone-900 mb-6 border-b-2 border-amber-500 pb-2">
      EPS â†’ BVPS / ROE æˆé•·æ¨¡æ“¬
      <span class="text-sm font-normal text-stone-600 block">æŠ•è³‡æ±ºç­–è¼”åŠ©å·¥å…·</span>
    </h1>

Â  Â  <!-- è¼¸å…¥å€ -->
Â  Â  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-6">
Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label for="eps" class="block mb-1 text-sm font-semibold text-stone-700">EPS é ä¼° (å…ƒ)</label>
Â  Â  Â  Â  <!-- ç„¦é»ç’°å’Œé‚Šæ¡†ä½¿ç”¨æ›´æ·±çš„ amber è‰²ç³» -->
Â  Â  Â  Â  <input id="eps" type="number" step="0.01" class="w-full p-3 border border-stone-400 rounded-lg focus:ring-amber-700 focus:border-amber-700 transition duration-150" placeholder="10.00" value="10">
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label for="payout" class="block mb-1 text-sm font-semibold text-stone-700">é…æ¯ç‡ (0~1)</label>
Â  Â  Â  Â  <input id="payout" type="number" step="0.01" class="w-full p-3 border border-stone-400 rounded-lg focus:ring-amber-700 focus:border-amber-700 transition duration-150" placeholder="0.80" value="0.8">
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label for="bvps" class="block mb-1 text-sm font-semibold text-stone-700">æœŸåˆæ¯è‚¡æ·¨å€¼ BVPS (å…ƒ)</label>
Â  Â  Â  Â  <input id="bvps" type="number" step="0.01" class="w-full p-3 border border-stone-400 rounded-lg focus:ring-amber-700 focus:border-amber-700 transition duration-150" placeholder="50.00" value="50">
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label for="growth" class="block mb-1 text-sm font-semibold text-stone-700">EPS å¹´æˆé•·ç‡ (0~1)</label>
Â  Â  Â  Â  <input id="growth" type="number" step="0.01" class="w-full p-3 border border-stone-400 rounded-lg focus:ring-amber-700 focus:border-amber-700 transition duration-150" placeholder="0.10" value="0.1">
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label for="years" class="block mb-1 text-sm font-semibold text-stone-700">æ¨¡æ“¬å¹´æ•¸ (æ•´æ•¸)</label>
Â  Â  Â  Â  <input id="years" type="number" step="1" class="w-full p-3 border border-stone-400 rounded-lg focus:ring-amber-700 focus:border-amber-700 transition duration-150" placeholder="5" value="5">
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- æŒ‰éˆ•ä¸»è‰²èª¿æ”¹ç‚ºæ¿ƒå’–å•¡è‰² bg-amber-800 -->
Â  Â  <button onclick="simulate()" class="w-full bg-amber-800 text-white p-3 rounded-xl hover:bg-amber-900 transition duration-200 font-bold text-lg shadow-md hover:shadow-lg mb-6">
      ğŸš€ åŸ·è¡Œæ¨¡æ“¬è¨ˆç®—
    </button>

Â  Â  <!-- çµæœå€ -->
Â  Â  <div id="results" class="hidden">
Â  Â  Â  <h2 class="text-2xl font-bold text-stone-800 mb-4">æ¨¡æ“¬çµæœèˆ‡èµ°å‹¢åˆ†æ</h2>

Â  Â  Â  <!-- ROE æŠ˜ç·šåœ– èƒŒæ™¯æ”¹ç‚º bg-stone-100 -->
      <div class="bg-stone-100 p-4 rounded-xl shadow-inner mb-6">
        <canvas id="roeChart" class="w-full h-80"></canvas>
      </div>

Â  Â  Â  <!-- çµæœè¡¨æ ¼ -->
      <div class="overflow-x-auto rounded-xl shadow-lg border border-stone-300">
        <!-- è¡¨æ ¼æ¨™é¡Œæ”¹ç‚ºæ¿ƒå’–å•¡è‰² bg-amber-800 -->
        <table class="table-auto border-collapse w-full text-left text-sm">
          <thead class="bg-amber-800 text-white">
            <tr>
              <th class="p-3">å¹´ä»½</th>
              <th class="p-3">æœŸæœ« EPS (å…ƒ)</th>
              <th class="p-3">æœŸæœ« BVPS (å…ƒ)</th>
              <th class="p-3">å¹´åŒ– ROE (%)</th>
            </tr>
          </thead>
          <tbody id="tableBody" class="divide-y divide-stone-200"></tbody>
        </table>
      </div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  let chart;

    /**
     * é¡¯ç¤ºè‡ªå®šç¾©çš„éé˜»æ–·å¼è¨Šæ¯æ¡† (Toast)
     * @param {string} message - è¦é¡¯ç¤ºçš„è¨Šæ¯å…§å®¹
     * @param {string} type - è¨Šæ¯é¡å‹ ('error' or 'success')
     */
    function showMessage(message, type = 'error') {
        const box = document.getElementById('messageBox');
        box.textContent = message;

        // è¨Šæ¯é¡è‰²èª¿æ•´ï¼šéŒ¯èª¤ç¶­æŒç´…è‰²ï¼›æˆåŠŸä½¿ç”¨æš–èª¿çš„ bg-emerald-600
        box.classList.remove('bg-red-600', 'bg-emerald-600');
        if (type === 'error') {
            box.classList.add('bg-red-600'); 
        } else {
            box.classList.add('bg-emerald-600');
        }

        // Show the box
        box.classList.remove('opacity-0', 'pointer-events-none');
        box.classList.add('opacity-100');

        // Hide after 4 seconds
        setTimeout(() => {
            box.classList.remove('opacity-100');
            box.classList.add('opacity-0', 'pointer-events-none');
        }, 4000);
    }

Â  Â  function simulate() {
Â  Â  Â  const eps0 = parseFloat(document.getElementById('eps').value);
Â  Â  Â  const payout = parseFloat(document.getElementById('payout').value);
Â  Â  Â  const bvps0 = parseFloat(document.getElementById('bvps').value);
Â  Â  Â  const growth = parseFloat(document.getElementById('growth').value);
Â  Â  Â  const years = parseInt(document.getElementById('years').value);

Â  Â  Â  // 1. ç¶œåˆé©—è­‰
Â  Â  Â  if ([eps0, payout, bvps0, growth, years].some(v => isNaN(v))) {
Â  Â  Â  Â  return showMessage("æ‰€æœ‰æ¬„ä½éƒ½å¿…é ˆå¡«å…¥æœ‰æ•ˆæ•¸å­—ã€‚");
Â  Â  Â  }
Â  Â  Â  if (payout < 0 || payout > 1) {
Â  Â  Â  Â  return showMessage("é…æ¯ç‡å¿…é ˆåœ¨ 0 åˆ° 1 ä¹‹é–“ã€‚");
Â  Â  Â  }
Â  Â  Â  if (bvps0 <= 0 || eps0 <= 0) {
Â  Â  Â  Â  return showMessage("æœŸåˆæ·¨å€¼èˆ‡ EPS é ä¼°å¿…é ˆç‚ºæ­£å€¼ã€‚");
Â  Â  Â  }
Â  Â  Â  if (years <= 0 || !Number.isInteger(years) || years > 15) {
Â  Â  Â  Â  return showMessage("æ¨¡æ“¬å¹´æ•¸å¿…é ˆæ˜¯ 1 åˆ° 15 ä¹‹é–“çš„æ•´æ•¸ã€‚");
Â  Â  Â  }

Â  Â  Â  const tableBody = document.getElementById('tableBody');
Â  Â  Â  tableBody.innerHTML = '';

Â  Â  Â  let bvps = bvps0; // æœŸåˆ BVPS
Â  Â  Â  let eps = eps0; Â  // æœŸåˆ EPS
Â  Â  Â  const labels = [];
Â  Â  Â  const roeData = [];
      const bvpsData = [];
      const epsData = [];


Â  Â  Â  for (let i = 1; i <= years; i++) {
Â  Â  Â  Â  // ç•¶æœŸç•™å­˜ç›ˆé¤˜ = EPS * (1 - é…æ¯ç‡)
Â  Â  Â  Â  const retained = eps * (1 - payout);

Â  Â  Â  Â  // æœŸæœ« BVPS = æœŸåˆ BVPS + ç•™å­˜ç›ˆé¤˜
Â  Â  Â  Â  const bvpsEnd = bvps + retained;
        
        // å¹´åŒ– ROE = EPS / å¹³å‡è‚¡æ±æ¬Šç›Š (æœŸåˆBVPS + æœŸæœ«BVPS) / 2
Â  Â  Â  Â  const avgBVPS = (bvps + bvpsEnd) / 2;
Â  Â  Â  Â  const roe = (eps / avgBVPS) * 100;

Â  Â  Â  Â  // è¨˜éŒ„æ•¸æ“š
Â  Â  Â  Â  labels.push(`ç¬¬ ${i} å¹´`);
Â  Â  Â  Â  roeData.push(roe.toFixed(2));
        bvpsData.push(bvpsEnd.toFixed(2));
        epsData.push(eps.toFixed(2));

Â  Â  Â  Â  // å¯«å…¥è¡¨æ ¼
Â  Â  Â  Â  const row = document.createElement('tr');
Â  Â  Â  Â  // æ»‘é¼ æ‡¸åœæ•ˆæœæ”¹ç‚ºæ·ºç¥ç€è‰²
Â  Â  Â  Â  row.classList.add('hover:bg-amber-50', 'transition', 'duration-100');
Â  Â  Â  Â  row.innerHTML = `<td class="p-3 font-semibold">${i}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <td class="p-3">${eps.toFixed(2)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <td class="p-3">${bvpsEnd.toFixed(2)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <!-- ROE æ•¸å­—é¡è‰²æ”¹ç‚ºæ·±å’–å•¡è‰² text-amber-800 -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <td class="p-3 font-bold text-amber-800">${roe.toFixed(2)}%</td>`;
Â  Â  Â  Â  tableBody.appendChild(row);

Â  Â  Â  Â  // æ›´æ–°ç‚ºä¸‹ä¸€æœŸæœŸåˆå€¼ (æœŸæœ« BVPS æˆç‚ºä¸‹ä¸€æœŸçš„æœŸåˆ BVPS)
Â  Â  Â  Â  bvps = bvpsEnd;
        
Â  Â  Â  Â  // è¨ˆç®—ä¸‹ä¸€æœŸ EPS
Â  Â  Â  Â  eps = eps * (1 + growth);
Â  Â  Â  }

Â  Â  Â  // é¡¯ç¤ºçµæœå€å¡Š
Â  Â  Â  document.getElementById('results').classList.remove('hidden');

Â  Â  Â  // ç¹ªè£½ ROE æŠ˜ç·šåœ–
Â  Â  Â  const ctx = document.getElementById('roeChart').getContext('2d');
Â  Â  Â  if (chart) chart.destroy();
Â  Â  Â  chart = new Chart(ctx, {
Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  labels: labels,
Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  label: 'å¹´åŒ– ROE (%)',
Â  Â  Â  Â  Â  Â  data: roeData,
Â  Â  Â  Â  Â  Â  // åœ–è¡¨ç·šæ¢é¡è‰²æ”¹ç‚ºæ¿ƒå’–å•¡è‰²
Â  Â  Â  Â  Â  Â  borderColor: 'rgb(120, 53, 15)', // æ¥è¿‘ amber-900
Â  Â  Â  Â  Â  Â  backgroundColor: 'rgba(234, 179, 8, 0.2)', // æ·ºç¥ç€è‰²èƒŒæ™¯å¡«å……
Â  Â  Â  Â  Â  Â  fill: true,
            tension: 0.3,
            pointRadius: 5
Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  },
Â  Â  Â  Â  options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'top',
            },
            title: {
                display: true,
                text: 'æ¨¡æ“¬ ROE è®ŠåŒ–è¶¨å‹¢',
                font: { size: 16, weight: 'bold' }
            }
          },
Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  y: { 
                beginAtZero: false,
                title: { display: true, text: 'ROE (%)' }
            },
            x: {
                title: { display: true, text: 'å¹´ä»½' }
            }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  });
       showMessage("æ¨¡æ“¬è¨ˆç®—å®Œæˆï¼", 'success');
Â  Â  }
Â  </script>
</body>
</html>
